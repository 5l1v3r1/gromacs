.TH tune_dip 1 "Thu 16 Oct 2008"
.SH NAME
tune_dip
.B VERSION 4.0_rc1
.SH SYNOPSIS
\f3tune_dip\fP
.BI "-f" " moldip.dat "
.BI "-d" " eemprops.dat "
.BI "-o" " molprops.dat "
.BI "-g" " charges.log "
.BI "-x" " dipcorr.xvg "
.BI "-[no]h" ""
.BI "-nice" " int "
.BI "-[no]w" ""
.BI "-[no]xvgr" ""
.BI "-tol" " real "
.BI "-maxiter" " int "
.BI "-reinit" " int "
.BI "-stol" " real "
.BI "-qgen" " enum "
.BI "-[no]fixenh" ""
.BI "-j0" " real "
.BI "-chi0" " real "
.BI "-w0" " real "
.BI "-j1" " real "
.BI "-chi1" " real "
.BI "-w1" " real "
.BI "-fc" " real "
.BI "-step" " real "
.BI "-elem" " string "
.BI "-seed" " int "
.BI "-[no]random" ""
.BI "-[no]zero" ""
.BI "-[no]weight" ""
.BI "-hfac" " real "
.BI "-[no]opthfac" ""
.BI "-slater_max" " int "
.SH DESCRIPTION
tune_dip read a series of molecules and corresponding experimental
dipole moments from a file, and tunes parameters in an algorithm
until the experimental dipole moments are reproduces by the
charge generating algorithm SM in the gentop program.


Minima and maxima for the parameters can be set, these are however
not strictly enforced, but rather they are penalized with a harmonic
function, for which the force constant can be set explicitly.


At every reinit step parameters are changed by a random amount within
the fraction set by step size, and within the boundaries given
by the minima and maxima.


The absolut dipole moment of a molecule remains unchanged if all the
atoms swap the sign of the charge. To prevent this kind of mirror
effects a penalty is added to the square deviation 
if hydrogen atoms have a negative charge. Similarly a penalty is
added if atoms from row VI or VII in the periodic table have a positive
charge. The penalty is equal to the force constant given on the command line
time the square of the charge.


One of the electronegativities (chi) is redundant in the optimization,
only the relative values are meaningful.
Therefore by default we fix the value for hydrogen to what is written
in the eemprops.dat file (or whatever is given with the 
-d
.B  flag).
A suitable value would be 2.3, the original, value due to Pauling,
this can by overridden by setting the 
-nofixenh
.B  flag.
.SH FILES
.BI "-f" " moldip.dat" 
.B Input
 Generic data file 

.BI "-d" " eemprops.dat" 
.B Input, Opt.
 Generic data file 

.BI "-o" " molprops.dat" 
.B Output
 Generic data file 

.BI "-g" " charges.log" 
.B Output
 Log file 

.BI "-x" " dipcorr.xvg" 
.B Output
 xvgr/xmgr file 

.SH OTHER OPTIONS
.BI "-[no]h"  "no    "
 Print help info and quit

.BI "-nice"  " int" " 0" 
 Set the nicelevel

.BI "-[no]w"  "no    "
 View output xvg, xpm, eps and pdb files

.BI "-[no]xvgr"  "yes   "
 Add specific codes (legends etc.) in the output xvg files for the xmgrace program

.BI "-tol"  " real" " 0.001 " 
 Tolerance for convergence in optimization

.BI "-maxiter"  " int" " 100" 
 Max number of iterations for optimization

.BI "-reinit"  " int" " 0" 
 After this many iterations the search vectors are randomized again. A vlue of 0 means this is never done at all.

.BI "-stol"  " real" " 1e-06 " 
 If reinit is -1 then a reinit will be done as soon as the simplex size is below this treshold.

.BI "-qgen"  " enum" " SMp" 
 Algorithm used for charge generation: 
.B SMp
, 
.B SMpp
, 
.B SMs
, 
.B SMps
, 
.B SMg
or 
.B SMgs


.BI "-[no]fixenh"  "yes   "
 Electronegativity for hydrogen. Set to FALSE if you want this variable as well, but read the help text above.

.BI "-j0"  " real" " 0     " 
 Minimum value that J0 can obtain in fitting

.BI "-chi0"  " real" " 0     " 
 Minimum value that Chi0 can obtain in fitting

.BI "-w0"  " real" " 0     " 
 Minimum value that Radius can obtain in fitting

.BI "-j1"  " real" " 30    " 
 Maximum value that J0 can obtain in fitting

.BI "-chi1"  " real" " 30    " 
 Maximum value that Chi0 can obtain in fitting

.BI "-w1"  " real" " 1     " 
 Maximum value that Radius can obtain in fitting

.BI "-fc"  " real" " 1     " 
 Force constant in the penalty function for going outside the borders given with the above six options.

.BI "-step"  " real" " 0.01  " 
 Step size in parameter optimization. Is used as a fraction of the starting value, should be less than 10%. At each reinit step the step size is updated.

.BI "-elem"  " string" " " 
 List of elements to optimize, e.g. "H C Br". The other available elements in gentop.xml are left unmodified

.BI "-seed"  " int" " 1993" 
 Random number seed for reinit

.BI "-[no]random"  "no    "
 Generate completely random starting parameters within the limits set by the options. This will be done at the very first step only.

.BI "-[no]zero"  "yes   "
 Use molecules with zero dipole in the fit as well

.BI "-[no]weight"  "yes   "
 Perform a weighted fit, by using the errors in the dipoles presented in the input file. This may or may not improve convergence.

.BI "-hfac"  " real" " 0     " 
 Fudge factor to scale the J00 of hydrogen by (1 + hfac * qH). Default hfac is 0, means no fudging.

.BI "-[no]opthfac"  "no    "
 Optimize the fudge factor to scale the J00 of hydrogen (see above). If set, then 
.B -hfac
set the absolute value of the largest hfac. Above this, a penalty is incurred.

.BI "-slater_max"  " int" " 6" 
 Largest Slater function to be used when optimizing EEM props

