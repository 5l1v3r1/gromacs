%
% $Id$
% 
%       This source code is part of
% 
%        G   R   O   M   A   C   S
% 
% GROningen MAchine for Chemical Simulations 
% 
%               VERSION 2.0
% 
% Copyright (c) 1991-1999
% BIOSON Research Institute, Dept. of Biophysical Chemistry
% University of Groningen, The Netherlands
% 
% Please refer to:
% GROMACS: A message-passing parallel molecular dynamics implementation
% H.J.C. Berendsen, D. van der Spoel and R. van Drunen
% Comp. Phys. Comm. 91, 43-56 (1995)
% 
% Also check out our WWW page:
% http://md.chem.rug.nl/~gmx
% or e-mail to:
% gromacs@chem.rug.nl
% 
% And Hey:
% Giving Russians Opium May Alter Current Situation
%

\chapter{Topologies}
\label{ch:top}
\section{Introduction}
{\gromacs} must know on which atoms and combinations of atoms the
various contributions to the potential functions (see
\chref{ff}) must act. It must
also know what \normindex{parameter}s must be applied to the various
functions. All this is described in the {\em \normindex{topology}} file
\verb'*.top', which lists the {\em constant attributes} of each atom.
There are many more atom types than elements, but only atom types
present in biological systems are parameterized in the force field,
plus some metals, ions and silicon. The bonded and special
interactions are determined by fixed lists that are included in the
topology file. Certain non-bonded interactions must be excluded (first
and second neighbors), as these are already treated in bonded
interactions.  In addition there are {\em dynamic attributes} of
atoms: their positions, velocities and forces, but these do not
strictly belong to the molecular topology.

This Chapter describes the set up of the topology file, the
{\tt *.top} file: what the parameters stand for and how/where to
change them if needed.

{\bf Note:} if you construct your own topologies, we encourage you
to upload them to our topology archive at www.gromacs.org! Just imagine
how thankful you'd have been if your topology had been available
there before you started. The same goes for new force field or
modified versions of the standard force fields - contribute them
to the force field archive!

The files are grouped per force field type (named {\eg} {\tt gmx} for
the {\gromacs} force field or {\tt G43a1} for the GROMOS96
force field). All files for one force field have names beginning with
{\tt ff???} where {\tt ???} stands for the force field name.

\section{Particle type}
\label{sec:parttype}

In {\gromacs} there are 5 types of \normindex{particle}s, see
\tabref{ptype}. Only regular atoms and dummy particles are used
in {\gromacs}, nuclei, shells and bond shells are necessary for
polarizable force fields, which we don't yet have.

\begin{table}
\centerline{
\begin{tabular}{|l|c|}
\dline
Particle        & Symbol        \\
\hline
\seeindex{atom}{particle}s      & A   \\
\seeindex{nucleus}{particle}s   & N   \\
\seeindex{shell}{particle}s     & S   \\
\seeindex{bond shell}{particle}s& B   \\
\seeindex{dummy}{particle}s     & D   \\
\dline
\end{tabular}
}
\caption{Particle types in {\gromacs}}
\label{tab:ptype}
\end{table}

\subsection{Atom types}
\label{subsec:atomtype}
{\gromacs} uses 47 different \swapindex{atom}{type}s, 
as listed below, with their
corresponding masses (in a.m.u.). This is the same listing as in the
file {\tt ff???.atp} (.atp = {\bf a}tom {\bf t}ype {\bf p}arameter
file), therefore in this file you can change and/or add an atom type.
{\small\begin{verbatim}
    O  15.99940 ;     carbonyl oxygen (C=O)
   OM  15.99940 ;     carboxyl oxygen (CO-)
   OA  15.99940 ;     hydroxyl oxygen (OH)
   OW  15.99940 ;     water oxygen
    N  14.00670 ;     peptide nitrogen (N or NH)
   NT  14.00670 ;     terminal nitrogen (NH2)
   NL  14.00670 ;     terminal nitrogen (NH3)
  NR5  14.00670 ;     aromatic N (5-ring,2 bonds)
 NR5*  14.00670 ;     aromatic N (5-ring,3 bonds)
   NP  14.00670 ;     porphyrin nitrogen
    C  12.01100 ;     bare carbon (peptide,C=O,C-N)
  CH1  13.01900 ;     aliphatic CH-group
  CH2  14.02700 ;     aliphatic CH2-group
  CH3  15.03500 ;     aliphatic CH3-group
 CR51  13.01900 ;     aromatic CH-group (5-ring), united
 CR61  13.01900 ;     aromatic CH-group (6-ring), united
   CB  12.01100 ;     bare carbon (5-,6-ring)
    H   1.00800 ;     hydrogen bonded to nitrogen
   HO   1.00800 ;     hydroxyl hydrogen
   HW   1.00800 ;     water hydrogen
   HS   1.00800 ;     hydrogen bonded to sulfur
    S  32.06000 ;     sulfur
   FE  55.84700 ;     iron
   ZN  65.37000 ;     zinc
   NZ  14.00670 ;     arg NH (NH2)
   NE  14.00670 ;     arg NE (NH)
    P  30.97380 ;     phosphor
   OS  15.99940 ;     sugar or ester oxygen
  CS1  13.01900 ;     sugar CH-group
  NR6  14.00670 ;     aromatic N (6-ring,2 bonds)
 NR6*  14.00670 ;     aromatic N (6-ring,3 bonds)
  CS2  14.02700 ;     sugar CH2-group
   SI  28.08000 ;     silicon
   NA  22.98980 ;     sodium (1+)
   CL  35.45300 ;     chlorine (1-)
   CA  40.08000 ;     calcium (2+)
   MG  24.30500 ;     magnesium (2+)
    F  18.99840 ;     fluorine (cov. bound)
  CP2  14.02700 ;     aliphatic CH2-group using Ryckaert-Bell.
  CP3  15.03500 ;     aliphatic CH3-group using Ryckaert-Bell.
  CR5  12.01100 ;     aromatic CH-group (5-ring)+H
  CR6  12.01100 ;     aromatic C- bonded to H (6-ring)+H
  HCR   1.00800 ;     H attached to aromatic C (5 or 6 ri
 OWT3  15.99940 ;     TIP3P water oxygen
   SD  32.06000 ;     DMSO Sulphur
   OD  15.99940 ;     DMSO Oxygen
   CD  15.03500 ;     DMSO Carbon
\end{verbatim}}
Atomic detail is used except for hydrogen atoms bound to (aliphatic)
carbon atoms, which are treated as {\em \swapindex{united}{atom}s}. No
special \normindex{hydrogen-bond} term is included.

The last 10 atom types are extra atom types with respect to the \gromosv{87}
force field~\cite{biomos}: 
\begin{itemize}
\item F was taken from ref.~\cite{Buuren93a}, 
\item CP2 and CP3 from ref.~\cite{Buuren93b} and references cited therein, 
\item CR5, CR6 and HCR from ref.~\cite{King93}
\item OWT3 from ref.~\cite{Jorgensen83}
\item SD, OD and CD from ref.~\cite{Liu95}
\end{itemize}
{\bf Therefore, if you use the {\gromacs} force field as it is, make
sure you use the references in your publications as mentioned above.}

{\bf Note:} {\gromacs} makes use of the atom types as a name, {\em
not} as a number (as {\eg} in {\gromos}).

%\subsection{Nucleus}
%{\em Necessary for \normindex{polarisability}, not implemented yet.}
%
%\subsection{Shell}
%{\em Necessary for polarisability, not implemented yet.}
%
%\subsection{Bond shell}
%{\em Necessary for polarisability, not implemented yet.}

\subsection{Dummy atoms}
\label{sec:dummytop}
Some \normindex{force field}s use \swapindex{dummy}{atom}s 
(\normindex{virtual site}s that are constructed
from real atoms) on which certain interactions are located
({\eg} on benzene rings, to reproduce the correct
\normindex{quadrupole}). This is described in~\secref{dummy}.

To make dummy atoms in your system, you should include a section
{\tt [~dummies?~]} in your topology file, where the `{\tt ?}' stands
for the number constructing atoms for the dummy atom. This will be
`{\tt 2}' for type 2, `{\tt 3}' for types 3, 3fd, 3fad and 3out and
`{\tt 4}' for type 4fd (the different types are explained
in~\secref{dummy}).

Parameters for type 2 should look like this:
{\small\begin{verbatim}
[ dummies2 ] 
; Dummy from        funct  a 
5       1     2     1      0.7439756
\end{verbatim}}

for type 3 like this:
{\small\begin{verbatim}
[ dummies3 ]
; Dummy from               funct   a          b
5       1     2     3      1       0.7439756  0.128012
\end{verbatim}}

for type 3fd like this:
{\small\begin{verbatim}
[ dummies3 ]
; Dummy from               funct   a          d
5       1     2     3      2       0.5        -0.105
\end{verbatim}}

for type 3fad like this:
{\small\begin{verbatim}
[ dummies3 ]
; Dummy from               funct   theta      d
5       1     2     3      3       120        0.5
\end{verbatim}}

for type 3out like this:
{\small\begin{verbatim}
[ dummies3 ]
; Dummy from               funct   a          b          c
5       1     2     3      4       -0.4       -0.4       6.9281
\end{verbatim}}

for type 4fd like this:
{\small\begin{verbatim}
[ dummies4 ]
; Dummy from                      funct   a          b          d
5       1     2     3     4       1       0.33333    0.33333    -0.105
\end{verbatim}}

This will result in the construction of a dummy `atom', number 5
(first column `{\tt Dummy}'), based on the positions of 1 and 2 or 1,
2 and 3 or 1, 2, 3 and 4 (next two, three or four columns
`{\tt from}') following the rules determined by the function number
(next column `{\tt funct}') with the parameters specified (last one,
two or three columns `{\tt a b} . .').

Note that any bonds defined between dummy atoms and/or normal atoms
will be removed by {\tt grompp} after the exclusions have been
generated. This way, exclusions will not be affected by an atom being
defined as dummy atom or not, but by the bonding configuration of the
atom.

\section{Parameter files}
\label{sec:paramfiles}
\subsection{Atoms}
A number of {\em static} properties are assigned to the atom types in
the {\gromacs} force field: Type, Mass, Charge, $\epsilon$ and
$\sigma$ (see \tabref{statprop} The mass is listed in {\tt ff???.atp}
(see~\ssecref{atomtype}), whereas the charge is listed in {\tt
ff???.rtp} (.rtp = {\bf r}esidue {\bf t}opology {\bf p}arameter file,
see~\ssecref{rtp}).  This implies that the charges are only defined in
the \normindex{building block}s of amino acids or user defined
building blocks.  When generating a topology ({\tt *.top}) using the
{\tt \normindex{pdb2gmx}} program the information from these files is
combined.
 
\begin{table}
\centerline{
\begin{tabular}{|l|c|c|}
\dline
Property        & Symbol        & Unit          \\
\hline
Type            & -             & -             \\
Mass            & m             & a.m.u.        \\
Charge          & q             & electron      \\
epsilon         & $\epsilon$    & kJ/mol        \\
sigma           & $\sigma$      & nm            \\
\dline
\end{tabular}
}
\caption{Static atom type properties in {\gromacs}}
\label{tab:statprop}
\end{table}

The following {\em dynamic} quantities are associated with an atom
\begin{itemize}
\item   Position {\bf x}
\item   Velocity {\bf v}
\end{itemize}
These quantities are listed in the coordinate file, {\tt *.gro}
(see section File format,~\ssecref{grofile}).

\subsection{Bonded parameters}
\label{subsec:bondparam}
The \swapindex{bonded}{parameter}s ({\ie} bonds, bond angles, improper and proper
dihedrals) are listed in {\tt ff???bon.itp}. The term {\tt func} is 1 for
harmonic and 2 for \gromosv{96} bond and angle potentials.
For the dihedral, this is explained after this listing.
{\small\begin{verbatim}
[ bondtypes ]
  ; i    j func        b0          kb
    C    O    1   0.12300     502080.
    C   OM    1   0.12500     418400.
    ......

[ angletypes ]
  ; i    j    k func       th0         cth
   HO   OA    C    1   109.500     397.480
   HO   OA  CH1    1   109.500     397.480
   ......

[ dihedraltypes ]
  ; i    l func        q0          cq
 NR5*  NR5    2     0.000     167.360
 NR5* NR5*    2     0.000     167.360
 ......

[ dihedraltypes ]
  ; j    k func      phi0          cp   mult
    C   OA    1   180.000      16.736      2
    C    N    1   180.000      33.472      2
    ......

[ dihedraltypes ]
;
; Ryckaert-Bellemans Dihedrals
;
; aj    ak      funct
CP2     CP2     3       9.2789  12.156  -13.120 -3.0597 26.240  -31.495
\end{verbatim}}
Also in this file are the \normindex{Ryckaert-Bellemans}~\cite{Ryckaert78} 
parameters for
the CP2-CP2 dihedrals in alkanes or alkane tails with the following
constants:

\begin{center}
(kJ/mol)\\
\begin{tabular}{llrllrllr}
$C_0$ & $=$ & $~ 9.28$ & $C_2$ & $=$ & $-13.12$ & $C_4$ & $=$ & $ 26.24$ \\
$C_1$ & $=$ & $ 12.16$ & $C_3$ & $=$ & $~-3.06$ & $C_5$ & $=$ & $-31.5 $ \\
\end{tabular}
\end{center}

({\bf Note:} The use of this potential implies exclusions of LJ-interactions
between the first and the last atom of the dihedral, and $\psi$ is defined
according to the '\swapindex{polymer}{convention}' ($\psi_{trans}=0$)).

So there are three types of dihedrals in the {\gromacs} force field:
\begin{itemize}
\item \swapindex{proper}{dihedral} : funct = 1, with mult = multiplicity, so the
                                   number of possible angles
\item \swapindex{improper}{dihedral} : funct = 2
\item Ryckaert-Bellemans dihedral : funct = 3
\end{itemize}
In the file {\tt ff???bon.itp} you can add bonded parameters. If you
want to include parameters for new atom types, make sure you define
this new atom type in {\tt ff???.atp} as well.

\subsection{Non-bonded parameters}
\label{subsec:nbpar}
The \swapindex{non-bonded}{parameter}s consist of the Van der Waals parameters
V ({\tt c6}) and W ({\tt c12}), as listed in the file {\tt ff???nb.itp},
where {\tt ptype} is the particle type (see \tabref{ptype}):
{\small\begin{verbatim}
[ atomtypes ]
;name        mass      charge   ptype            c6           c12
    O    15.99940       0.000       A   0.22617E-02   0.74158E-06
   OM    15.99940       0.000       A   0.22617E-02   0.74158E-06
   .....

[ nonbond_params ]
  ; i    j func          c6           c12
    O    O    1 0.22617E-02   0.74158E-06
    O   OA    1 0.22617E-02   0.13807E-05
    .....

[ pairtypes ]
  ; i    j func         cs6          cs12 ; THESE ARE 1-4 INTERACTIONS
    O    O    1 0.22617E-02   0.74158E-06
    O   OM    1 0.22617E-02   0.74158E-06
    .....
\end{verbatim}}
The parameters V and W can be defined in two different ways, depending on
the combination rule that was chosen in the {\tt [~defaults~]} section
op the topology file (see~\ssecref{topfile}):
\begin{eqnarray}
\mbox{for combination rule 1}: & &
\begin{array}{llllll}
  \mbox{V}_{ii} & = & C^{(6)}_{i}  & = & 4\,\epsilon_i\sigma_i^{6} &
  \mbox{[ kJ mol$^{-1}$ nm$^{6}$ ]}\\
  \mbox{W}_{ii} & = & C^{(12)}_{i} & = & 4\,\epsilon_i\sigma_i^{12} &
  \mbox{[ kJ mol$^{-1}$ nm$^{12}$ ]}\\
\end{array}
\\
\mbox{for combination rules 2 and 3}: & &
\begin{array}{llll}
  \mbox{V}_{ii} & = & \sigma_i   & \mbox{[ nm ]} \\
  \mbox{W}_{ii} & = & \epsilon_i & \mbox{[ kJ mol$^{-1}$ ]}
\end{array}
\end{eqnarray}
Some or all combinations for different atom-types can be given in
the {\tt [~nonbond\_params~]} section. Any combination that is
not given will be 
computed according to the \normindex{combination rule}:
\begin{eqnarray}
\mbox{for combination rules 1 and 3}: & &
\begin{array}{lll}
  C^{(6)}_{ij}  & = & \left(C^{(6)}_i\,C^{(6)}_j\right)^{\frac{1}{2}} \\
  C^{(12)}_{ij} & = & \left(C^{(12)}_i\,C^{(12)}_j\right)^{\frac{1}{2}}
\end{array}
\\
\mbox{for combination rule 2}: & &
\begin{array}{lll}
  \sigma_{ij}   & = & \frac{1}{2}(\sigma_i+\sigma_j) \\
  \epsilon_{ij} & = & \sqrt{\epsilon_i\,\epsilon_j}
\end{array}
\end{eqnarray}

\subsection{1-4 interactions}
The \swapindex{1-4}{interaction}s for the atom types
in {\tt ff???nb.itp} are listed in the {\tt [~pairtypes~]} section.
The GROMACS and GROMOS force fields lists all these interactions 
explicitly, but this section might be empty for force fields like
OPLS that calculate the 1-4 interactions by scaling.

\subsection{\normindex{Exclusions}}
\label{subsec:excl}
The exclusions for bonded particles are generated by {\tt
grompp} for neighboring atoms up to a certain number of bonds away, as
defined in the {\tt [~moleculetype~]} section in the topology file
(see \ssecref{topfile}). Particles are considered bonded when they are
connected by bonds ({\tt [~bonds~]} types 1 to 5) or constraints ({\tt
[~constraints~]} type 1).
{\tt[~bonds~]} type 5 can be used to create a \normindex{connection}
between two atoms without creating an interaction.
There is a \normindex{harmonic interaction}
({\tt[~bonds~]} type 6) which does not connect the atoms by a chemical bond.
There is also a second constraint type ({\tt[~constraints~]} type 2)
which fixes the distance, but does not connect
the atoms by a chemical bond.

Extra exclusions within a molecule can be added manually
in a {\tt [~exclusions~]} section. Each line should start with one
atom index, followed by one or more atom indices. All non-bonded
interactions between the first atom and the other atoms will be excluded.

When all non-bonded interactions within or between groups of atoms need
to be excluded, is it more convenient and much more efficient to use
energy monitor group exclusions (see \secref{group}).

\section{\normindex{Constraint}s}
\label{sec:constraints}
Constraints are defined in the {\tt [~constraints~]} section.
The format is two atom numbers followed by the function type,
which can be 1 or 2 and the constraint distance.
The only difference between the two types is that type 1 is used
for generating exclusions and while type 2 is not (see \ssecref{excl}).
The distances are constrained using the LINCS or the SHAKE algorithm,
which can be selected in the {\tt *.mdp} file.
Both types of constraints can be perturbed in free-energy calculations
by adding a second constraint distance (see \ssecref{constraintforce}).
Several types of bonds and angles (see \tabref{topfile2}) can
be converted automatically to constraints by {\tt grompp}.
There are several options for this in the {\tt *.mdp} file.

We have also implemented the \normindex{SETTLE} algorithm~\cite{Miyamoto92}
which is an analytical solution of SHAKE specifically for water. 
SETTLE can be selected in the topology file. Check for instance the
SPC molecule definition:
\begin{verbatim}
[ moleculetype ]
; molname       nrexcl
SOL             1

[ atoms ]
; nr    at type res nr  ren nm  at nm   cg nr   charge
1       OW      1       SOL     OW1     1       -0.82
2       HW      1       SOL     HW2     1        0.41
3       HW      1       SOL     HW3     1        0.41

[ settles ]
; OW    funct   doh     dhh
1       1       0.1     0.16333

[ exclusions ]
1       2       3
2       1       3
3       1       2
\end{verbatim}
The section {\tt [ settles ]} defines the first atom of the watery molecule,
the settle funct is always one, and the distance between O and H, and distance
between both H atoms must be given. Note that the algorithm can also be used
for TIP3P and TIP4P~\cite{Jorgensen83}.
TIP3P just has another geometry. TIP4P has a dummy atom, but since 
that is generated it does not need to be shaken (nor stirred).

\section{\normindex{Database}s}

\subsection{Residue database}
\label{subsec:rtp}
The file holding the residue database is {\tt ff???.rtp}. Originally
this file contained building blocks (amino acids) for proteins, and is
the {\gromacs} interpretation of the {\tt rt37c4.dat} file of {\gromos}. So
the residue file contains information (bonds, charge, charge groups
and improper dihedrals) for a frequently used building block. It is
better {\em not} to change this file because it is standard input for
{\tt pdb2gmx}, but if changes are needed make them in the
{\tt *.top} file (see~\ssecref{topfile}). 
However, in the {\tt ff???.rtp} file the user can define a new
\normindex{building block} or molecule: see for example 2,2,2-trifluoroethanol
(TFE) or {\em n}-decane (C10). But when defining new molecules
(non-protein) it is preferable to create a {\tt *.itp}
file. This will be discussed in a next section (section~\ssecref{molitp}).

The file {\tt ff???.rtp} is only used by {\tt pdb2gmx}.
As mentioned before, the only extra information this
program needs from {\tt ff???.rtp} is bonds, charges of atoms,
charge groups and improper dihedrals, because the rest is read from
the coordinate input file (in the case of {\tt pdb2gmx}, a pdb format
file). Some proteins contain residues that are not standard, but are
listed in the coordinate file. You have to construct a building block
for this ``strange'' residue, otherwise you will not obtain a
{\tt *.top} file. This also holds for molecules in the
coordinate file like phosphate or sulphate ions.
The residue database is constructed in the following way:
{\small\begin{verbatim}
[ bondedtypes ]  ; mandatory
; bonds  angles  dihedrals  impropers
     1       1          1          2  ; mandatory

[ GLY ]  ; mandatory

 [ atoms ]  ; mandatory 
; name  type  charge  chargegroup 
     N     N  -0.280     0
     H     H   0.280     0
    CA   CH2   0.000     1
     C     C   0.380     2
     O     O  -0.380     2

 [ bonds ]  ; optional
;atom1 atom2      b0      kb
     N     H
     N    CA
    CA     C
     C     O
    -C     N

 [ exclusions ]  ; optional
;atom1 atom2

 [ angles ]  ; optional
;atom1 atom2 atom3    th0    cth

 [ dihedrals ]  ; optional
;atom1 atom2 atom3 atom4   phi0     cp   mult

 [ impropers ]  ; optional
;atom1 atom2 atom3 atom4     q0     cq
     N    -C    CA     H
    -C   -CA     N    -O


[ ZN ]
 [ atoms ]
    ZN    ZN   2.000     0
\end{verbatim}}

The file is free format, the only restriction is that there can be at
most one entry on a line.  The first field in the file is the {\tt
[~bondedtypes~]} field, which is followed by four numbers, that
indicate the interaction type for bonds, angles, dihedrals and
improper dihedrals.  The file contains residue entries, which consist
of atoms and optionally bonds, angles dihedrals and impropers.  The
charge group codes denote the charge group numbers. Atoms in the same
charge group should always be below each other. When using the
hydrogen database with {\tt pdb2gmx} for adding missing hydrogens, the
atom names defined in the {\tt .rtp} entry should correspond exactly
to the naming convention used in the hydrogen database,
see~\ssecref{hdb}. The atom names in the bonded interaction can be
preceded by a minus or a plus, indicating that the atom is in the
preceding or following residue respectively.  Parameters can be added
to bonds, angles, dihedrals and impropers, these parameters override
the standard parameters in the {\tt .itp} files.  This should only be
used in special cases. Instead of parameters, a string can be added
for each bonded interaction, this is used in \gromos{96} {\tt .rtp}
files. These strings are copied to the topology file and can be
replaced by force field parameters by the C-preprocessor in {\tt
grompp} using {\tt \#define} statements.

{\tt pdb2gmx} automatically generates all angles, this means that for the
{\gromacs} force field
the {\tt [~angles~]} field is only useful for overriding {\tt .itp}
parameters. For the {\gromosv{96}} force field the interaction number
off all angles need to be specified.

{\tt pdb2gmx} automatically generates one proper dihedral for every rotatable
bond, preferably on heavy atoms. When the {\tt [~dihedrals~]} field is used,
no other dihedrals will be generated for the bonds corresponding to the
specified  dihedrals. It is possible to put more than one dihedral on a
rotatable bond. 

{\tt pdb2gmx} sets the number exclusions to 3, which
means that interactions between atoms connected by at most 3 bonds are
excluded. Pair interactions are generated for all pairs of atoms which are
seperated by 3 bonds (except pairs of hydrogens).
When more interactions need to be excluded, or some pair interactions should
not be generated, an {\tt [~exclusions~]} field can be added, followed by
pairs of atom names on seperate lines. All non-bonded and pair interactions
between these atoms will be excluded.

\subsection{Hydrogen database}
\label{subsec:hdb}
The \swapindex{hydrogen}{database} is stored in {\tt ff???.hdb}. It
contains information for the {\tt pdb2gmx} program on how to connect
hydrogen atoms to existing atoms. Hydrogen atoms are named after the
atom they are connected to: the first letter of the atom name is
replaced by an 'H'. If more then one hydrogen atom is connected to the
same atom, a number will be added to the end of the hydrogen atom
name. For example, adding two hydrogen atoms to {\tt ND2} (in
asparagine), the hydrogen atoms will be named {\tt HD21} and {\tt
HD22}. This is important since atom naming in the {\tt .rtp} file
(see~\ssecref{rtp}) must be the same. The format of the hydrogen
database is as follows:
%
{\small\begin{verbatim}
; res   # additions
        # H add type    i       j       k
ALA     1
        1       1       N       -C      CA
ARG     4
        1       2       N       CA      C
        1       1       NE      CD      CZ
        2       3       NH1     CZ      NE
        2       3       NH2     CZ      NE
\end{verbatim}
}

On the first line we see the residue name (ALA or ARG) and the number
of additions. After that follows one line for each addition, on which
we see:
\begin{itemize}
\item The number of H atoms added
\item The way of adding H atoms, can be any of
\begin{enumerate}
\item[1]{\em one planar hydrogen, {\eg} rings or peptide bond}\\
one hydrogen atom (n) is generated, lying in the plane of atoms
(i,j,k) on the line bisecting angle (j-i-k) at a distance of 0.1 nm
from atom i, such that the angles (n-i-j) and (n-i-k) are $>$ 90
degrees
\item[2]{\em one single hydrogen, {\eg} hydroxyl}\\
one hydrogen atom (n) is generated at a distance of 0.1 nm from atom
i, such that angle (n-i-j)=109.5 degrees and dihedral (n-i-j-k)=trans
\item[3]{\em two planar hydrogens, {\eg} -NH{$_2$}}\\
two hydrogens (n1,n2) are generated at a distance of 0.1 nm from atom
i, such that angle (n1-i-j)=(n2-i-j)=120 degrees and dihedral
(n1-i-j-k)=cis and (n2-i-j-k)=trans, such that names are according to
IUPAC standards~\cite{iupac70}
\item[4]{\em two or three tetrahedral hydrogens, {\eg} -CH{$_3$}}\\
three (n1,n2,n3) or two (n1,n2) hydrogens are generated at a distance
of 0.1 nm from atom i, such that angle
(n1-i-j)=(n2-i-j)=(n3-i-j)=109.5, dihedral (n1-i-j-k)=trans,
(n2-i-j-k)=trans+120 and (n3-i-j-k)=trans+240 degrees
\item[5]{\em one tetrahedral hydrogen, {\eg} C{$_3$}CH}\\
one hydrogen atom (n1) is generated at a distance of 0.1 nm from atom
i in tetrahedral conformation such that angle
(n1-i-j)=(n1-i-k)=(n1-i-l)=109.5 degrees
\item[6]{\em two tetrahedral hydrogens, {\eg} C-CH{$_2$}-C}\\
two hydrogen atoms (n1,n2) are generated at a distance of 0.1 nm from
atom i in tetrahedral conformation on the plane bissecting angle i-j-k
with angle (n1-i-n2)=(n1-i-j)=(n1-i-k)=109.5
\item[7]{\em two water hydrogens}\\
two hydrogens are generated around atom i according to
SPC~\cite{Berendsen81} water geometry. The symmetry axis will
alternate between three coordinate axes in both directions
\end{enumerate}
\item
Three or four control atoms (i,j,k,l), where the first always is the
atom to which the H atoms are connected. The other two or three depend
on the code selected.
\end{itemize}

\subsection{Termini database}
The \swapindex{termini}{database}s are stored in {\tt ff???-n.tdb} and
{\tt ff???-c.tdb} for the N- and C-termini respectively. They contain
information for the {\tt pdb2gmx} program on how to connect new atoms
to existing ones, which atoms should be removed or changed and which
bonded interactions should be added. The format of the is as follows
(this is an example from the {\tt ffgmx-c.tdb}):
%
{\small\begin{verbatim}
[ None ]

[ COO- ]
[ replace ]
C       C       C       12.011  0.27
[ add ]
2       8       C       CA      N
        O       OM      15.9994 -0.635
[ delete ]
O
[ impropers ]
C       O1      O2      CA
\end{verbatim}
}

The file is organized in blocks, each with a header specifying the
name of the block. These blocks correspond to different types of
termini that can be added to a molecule. In this example {\tt
[~None~]} is the first block, corresponding to a terminus that leaves
the molecule as it is; {\tt [~COO-~]} is the second terminus type,
corresponding to changing the terminal carbon atom into a deprotonated
carboxyl group. Block names cannot be any of the following: {\tt
replace}, {\tt add}, {\tt delete}, {\tt bonds}, {\tt angles}, {\tt
dihedrals}, {\tt impropers}; this would interfere with the parameters
of the block, and would probably also be very confusing to human
readers.

Per block the following options are present:
\begin{itemize}
\item {\tt [~replace~]} \\
replace an existing atom by one with a different atom type, atom name,
charge and/or mass. For each atom to be replaced on line should be
entered with the following fields:
\begin{itemize}
\item name of the atom to be replaced
\item new atom name
\item new atom type
\item new mass
\item new charge
\end{itemize}
\item {\tt [~add~]} \\
add new atoms. For each (group of) added atom(s), a two-line entry is
necessary. The first line contains the same fields as an entry in the
hydrogen database (number of atoms, type of addition, control atoms,
see~\ssecref{rtp}), but the possible types of addition are extended
by two more, specifically for C-terminal additions:
\begin{enumerate}
\item[8]{\em two carboxyl oxygens, -COO{$^-$}}\\
two oxygens (n1,n2) are generated according to rule 3, at a distance
of 0.136 nm from atom i and an angle (n1-i-j)=(n2-i-j)=117 degrees
\item[9]{\em carboxyl oxygens and hydrogen, -COOH}\\
two oxygens (n1,n2) are generated according to rule 3, at distances of
0.123 nm and 0.125 nm from atom i for n1 and n2 resp. and angles
(n1-i-j)=121 and (n2-i-j)=115 degrees. One hydrogen (n') is generated
around n2 according to rule 2, where n-i-j and n-i-j-k should be read
as n'-n2-i and n'-n2-i-j resp.
\end{enumerate}
After this line another line follows which specifies the details of
the added atom(s), in the same way as for replacing atoms, {\ie}: 
\begin{itemize}
\item atom name
\item atom type
\item mass
\item charge
\end{itemize}
Like in the hydrogen database (see~\ssecref{rtp}), when more then
one atom is connected to an existing one, a number will be appended to
the end of the atom name.
\item {\tt [~delete~]}\\
delete existing atoms. One atom name per line.
\item {\tt [~bonds~]}, {\tt [~angles~]}, {\tt [~dihedrals~]} and {\tt [~impropers~]}\\
add additional bonded parameters. The format is identical to that used
in the {\tt ff???.rtp}, see~\ssecref{rtp}.
\end{itemize}

\section{File formats}
\subsection{\swapindex{Topology}{file}}
\label{subsec:topfile}
The topology file is built following the {\gromacs} specification for a
molecular topology.  A {\tt *.top} file can be generated by
{\tt pdb2gmx}.

% move these figures so they end up on facing pages 
% (first figure on even page)
\input{topolfig}

Description of the file layout:
\begin{itemize}
\item semicolon (;) and newline surround comments
\item on a line ending with $\backslash$ the newline character is ignored.
\item directives are surrounded by {\tt [} and {\tt ]}
\item the topology consists of three levels:
\begin{itemize}
\item the parameter level (see \tabref{topfile1})
\item the molecule level, which should contain one or more molecule
      definitions (see \tabref{topfile2})
\item the system level: {\tt [~system~]}, {\tt [~molecules~]}
\end{itemize}
\item items should be separated by spaces or tabs, not commas
\item atoms in molecules should be numbered consecutively starting at 1
\item the file is parsed once only which implies that no forward
      references can be treated: items must be defined before they
      can be used
\item exclusions can be generated from the bonds or
      overridden manually
\item the bonded force types can be generated from the atom types or
      overridden per bond
\item descriptive comment lines and empty lines are highly recommended
\item using one of the {\tt [~atoms~]}, {\tt [~bonds~]}, 
      {\tt [~pairs~]}, {\tt [~angles~]}, etc. without having used 
      {\tt [~moleculetype~]} 
      before is meaningless and generates a warning.
\item using {\tt [~molecules~]} without having used
      {\tt [~system~]} before is meaningless and generates a warning.
\item after {\tt [~system~]} the only allowed directive is {\tt [~molecules~]}
\item using an unknown string in {\tt [~]} causes all the data until
      the next directive to be ignored, and generates a warning.
\end{itemize}

Here is an example of a topology file, {\tt urea.top}:
{\small\begin{verbatim}
;
;       Example topology file
;
; The force field files to be included
#include "ffgmx.itp"

[ moleculetype ]
; name  nrexcl
Urea         3

[ atoms ]
;   nr    type   resnr  residu    atom    cgnr  charge
     1       C       1    UREA      C1       1   0.683
     2       O       1    UREA      O2       1  -0.683
     3      NT       1    UREA      N3       2  -0.622
     4       H       1    UREA      H4       2   0.346
     5       H       1    UREA      H5       2   0.276
     6      NT       1    UREA      N6       3  -0.622
     7       H       1    UREA      H7       3   0.346
     8       H       1    UREA      H8       3   0.276

[ bonds ]
;  ai    aj funct           b0           kb
    3     4     1 1.000000e-01 3.744680e+05 
    3     5     1 1.000000e-01 3.744680e+05 
    6     7     1 1.000000e-01 3.744680e+05 
    6     8     1 1.000000e-01 3.744680e+05 
    1     2     1 1.230000e-01 5.020800e+05 
    1     3     1 1.330000e-01 3.765600e+05 
    1     6     1 1.330000e-01 3.765600e+05 

[ pairs ]
;  ai    aj funct           c6          c12
    2     4     1 0.000000e+00 0.000000e+00 
    2     5     1 0.000000e+00 0.000000e+00 
    2     7     1 0.000000e+00 0.000000e+00 
    2     8     1 0.000000e+00 0.000000e+00 
    3     7     1 0.000000e+00 0.000000e+00 
    3     8     1 0.000000e+00 0.000000e+00 
    4     6     1 0.000000e+00 0.000000e+00 
    5     6     1 0.000000e+00 0.000000e+00 

[ angles ]
;  ai    aj    ak funct          th0          cth
    1     3     4     1 1.200000e+02 2.928800e+02 
    1     3     5     1 1.200000e+02 2.928800e+02 
    4     3     5     1 1.200000e+02 3.347200e+02 
    1     6     7     1 1.200000e+02 2.928800e+02 
    1     6     8     1 1.200000e+02 2.928800e+02 
    7     6     8     1 1.200000e+02 3.347200e+02 
    2     1     3     1 1.215000e+02 5.020800e+02 
    2     1     6     1 1.215000e+02 5.020800e+02 
    3     1     6     1 1.170000e+02 5.020800e+02 

[ dihedrals ]
;  ai    aj    ak    al funct          phi           cp         mult
    2     1     3     4     1 1.800000e+02 3.347200e+01 2.000000e+00 
    6     1     3     4     1 1.800000e+02 3.347200e+01 2.000000e+00 
    2     1     3     5     1 1.800000e+02 3.347200e+01 2.000000e+00 
    6     1     3     5     1 1.800000e+02 3.347200e+01 2.000000e+00 
    2     1     6     7     1 1.800000e+02 3.347200e+01 2.000000e+00 
    3     1     6     7     1 1.800000e+02 3.347200e+01 2.000000e+00 
    2     1     6     8     1 1.800000e+02 3.347200e+01 2.000000e+00 
    3     1     6     8     1 1.800000e+02 3.347200e+01 2.000000e+00 

[ dihedrals ]
;  ai    aj    ak    al funct           q0           cq
    3     4     5     1     2 0.000000e+00 1.673600e+02 
    6     7     8     1     2 0.000000e+00 1.673600e+02 
    1     3     6     2     2 0.000000e+00 1.673600e+02 
 
[ position_restraints ]
; you wouldn't normally use this for a molecule like Urea,
; but it's here for didactical purposes
; ai   funct    fc
   1     1     1000    1000    1000 ; Restrain to a point
   2     1     1000       0    1000 ; Restrain to a line (Y-axis)
   3     1     1000       0       0 ; Restrain to a plane (Y-Z-plane)

; Include SPC water topology
#include "spc.itp"

[ system ]
Urea in Water

[ molecules ]
;molecule name   nr.
Urea             1
SOL              1000
\end{verbatim}}

Here follows the explanatory text.

{\bf {\tt [~defaults~]} :}
\begin{itemize}
\item non-bond type = 1 (Lennard-Jones) or 2 (Buckingham)\\
{\bf note:} when using the Buckingham potential no combination rule can
be used, and a full interaction matrix must be provided under the 
{\tt nonbond\_params} section.
\item \normindex{combination rule} = 
1 (supply $C^{(6)}$ and $C^{(12)}$,
$\sigma_{ij}=\sqrt{\sigma_i\,\sigma_j}$),
2 (supply $\sigma$ and $\epsilon$,
$\sigma_{ij}=\frac{1}{2}(\sigma_i+\sigma_j)$) or
3 (supply $\sigma$ and $\epsilon$, $\sigma_{ij}=\sqrt{\sigma_i\,\sigma_j}$)
\item generate pairs = no (get 1-4 interactions from pair list) or yes
(generate 1-4 interactions from normal Lennard-Jones parameters using
FudgeLJ and FudgeQQ)
\item FudgeLJ = factor to change Lennard-Jones 1-4 interactions
\item FudgeQQ = factor to change electrostatic 1-4 interactions
\end{itemize}
{\bf note:} FudgeLJ and FudgeQQ only need to be specified when
generate pairs is set to 'yes'.

% move these figures so they end up on facing pages 
% (first figure on even page)
%\input{topolfig}

{\bf {\tt \#include "ffgmx.itp"} :} this includes the bonded and
non-bonded {\gromacs} parameters, the {\tt gmx} in {\tt ffgmx} will be
replaced by the name of the force field you are actually using.

{\bf {\tt [~moleculetype~]} :} defines the name of your molecule in
this {\tt *.top} and nrexcl = 3 stands for excluding non-bonded
interactions between atoms that are no further than 3 bonds away.

{\bf {\tt [~atoms~]} :} defines the molecule, where {\tt nr} and {\tt
type} are fixed, the rest is user defined. So {\tt atom} can be named
as you like, {\tt cgnr} made larger or smaller (if possible, the total
charge of a charge group should be zero), and charges can be changed
here too.

{\bf {\tt [~bonds~]} :} no comment.

{\bf {\tt [~pairs~]} :} 1-4 interactions

{\bf {\tt [~angles~]} :} no comment

{\bf {\tt [~dihedrals~]} :} in this case there are 9 proper dihedrals
(funct = 1), 3 improper (funct = 2) and no Ryckaert-Bellemans type
dihedrals. If you want to include Ryckaert-Bellemans type dihedrals
in a topology, do the following (in case of {\eg} decane):
\begin{verbatim}
[ dihedrals ]
;  ai    aj    ak    al funct       c0       c1       c2
    1    2     3     4     3 
    2    3     4     5     3
\end{verbatim}
and do not forget to {\em erase the 1-4 interaction} 
in {\tt [~pairs~]}!!

{\bf {\tt [~position\_restraints~]} :} harmonically restrain the selected particles
to reference positions (\secref{posre}). 
The reference positions are read from a 
separate coordinate file by \normindex{grompp}.

{\bf {\tt \#include "spc.itp"} :} includes a topology file that was already
constructed (see next section, molecule.itp).

{\bf {\tt [~system~]} :} title of your system, user defined

{\bf {\tt [~molecules~]} :} this defines the total number of (sub)molecules
in your system that are defined in this {\tt *.top}. In this
example file it stands for 1 urea molecules dissolved in 1000 water
molecules. The molecule type SOL is defined in the {\tt spc.itp} file.

\subsection{Molecule.itp file}
\label{subsec:molitp}
If you construct a topology file you will use more often (like a water
molecule, {\tt spc.itp}) it is better to make a {\tt molecule.itp}
file, which only lists the information of the molecule: 
{\small\begin{verbatim}
[ moleculetype ]
; name  nrexcl
Urea       3

[ atoms ]
;   nr    type   resnr  residu    atom    cgnr  charge
     1       C       1    UREA      C1       1   0.683  
     .................
     .................
     8       H       1    UREA      H8       3   0.276

[ bonds ]
;  ai    aj funct           c0           c1
    3     4     1 1.000000e-01 3.744680e+05 
     .................
     .................
    1     6     1 1.330000e-01 3.765600e+05 

[ pairs ]
;  ai    aj funct           c0           c1
    2     4     1 0.000000e+00 0.000000e+00 
     .................
     .................
    5     6     1 0.000000e+00 0.000000e+00 

[ angles ]
;  ai    aj    ak funct           c0           c1
    1     3     4     1 1.200000e+02 2.928800e+02 
     .................
     .................
    3     1     6     1 1.170000e+02 5.020800e+02 

[ dihedrals ]
;  ai    aj    ak    al funct           c0           c1           c2
    2     1     3     4     1 1.800000e+02 3.347200e+01 2.000000e+00 
     .................
     .................
    3     1     6     8     1 1.800000e+02 3.347200e+01 2.000000e+00 

[ dihedrals ]
;  ai    aj    ak    al funct           c0           c1
    3     4     5     1     2 0.000000e+00 1.673600e+02 
    6     7     8     1     2 0.000000e+00 1.673600e+02 
    1     3     6     2     2 0.000000e+00 1.673600e+02 
\end{verbatim}
}
This results in a very short {\tt *.top} file as described in the
previous section, but this time you only need to include files:
{\small\begin{verbatim}
; The force field files to be included
#include "ffgmx.itp"
        
; Include urea topology
#include "urea.itp"

; Include SPC water topology
#include "spc.itp"

[ system ]
Urea in Water

[ molecules ]
;molecule name  number
Urea              1
SOL               1000
\end{verbatim}}

\subsection{Ifdef option}
\label{subsec:ifdef}
A very powerful feature in {\gromacs} is the use of {\tt \#ifdef}
statements in your {\tt *.top} file. By making use of this statement,
different parameters for one molecule can be used in the same {\tt
*.top} file. An example is given for TFE, where there is an option to
use different charges on the atoms: charges derived by De Loof
{\etal}~\cite{Loof92} or by Van Buuren and
Berendsen~\cite{Buuren93a}. In fact you can use all the options of the
C-Preprocessor, {\tt cpp}, because this is used to scan the file.  The
way to make use of the {\tt \#ifdef} option is as follows:
\begin{itemize}
\item in {\tt grompp.mdp} (the {\gromacs} preprocessor input
      parameters) use the option\\{\tt define = -DDeloof}\\ or
      \\{\tt define = }
\item put the {\tt \#ifdef} statements in your {\tt *.top}, as
      shown below: 
\end{itemize}
{\small\begin{verbatim}
...

[ atoms ]
; nr   type   resnr  residu   atom    cgnr    charge      mass
#ifdef DeLoof
; Use Charges from DeLoof
   1      C      1    TFE       C       1       0.74
   2      F      1    TFE       F       1      -0.25
   3      F      1    TFE       F       1      -0.25
   4      F      1    TFE       F       1      -0.25
   5    CH2      1    TFE     CH2       1       0.25
   6     OA      1    TFE      OA       1      -0.65
   7     HO      1    TFE      HO       1       0.41
#else
; Use Charges from VanBuuren
   1      C      1    TFE       C       1       0.59
   2      F      1    TFE       F       1      -0.2
   3      F      1    TFE       F       1      -0.2
   4      F      1    TFE       F       1      -0.2
   5    CH2      1    TFE     CH2       1       0.26
   6     OA      1    TFE      OA       1      -0.55
   7     HO      1    TFE      HO       1       0.3
#endif

[ bonds ]
;  ai    aj funct           c0           c1
    6     7     1 1.000000e-01 3.138000e+05 
    1     2     1 1.360000e-01 4.184000e+05 
    1     3     1 1.360000e-01 4.184000e+05 
    1     4     1 1.360000e-01 4.184000e+05 
    1     5     1 1.530000e-01 3.347000e+05 
    5     6     1 1.430000e-01 3.347000e+05 

...
\end{verbatim}}

\subsection{\normindex{Free energy calculations}}

Free energy differences between two systems A and B can be calculated as
described in \secref{fecalc}.
The systems A and B are described by topologies
consisting of the same number of molecules with the same number of
atoms. Masses and non-bonded interactions can be perturbed by adding B
parameters in the {\tt [~atoms~]} field. Bonded interactions can be 
perturbed by adding B parameters to the bonded types or the bonded
interactions. The parameters that can be perturbed are listed in  
\tabref{topfile1} and \tabref{topfile2}.
The $\lambda$-dependence of the interactions is described
in section \secref{feia}.
Below is an example of a topology which changes from 200 propanols to
200 pentanes using the \gromosv{96} force field.
{\small\begin{verbatim}
; Include forcefield parameters
#include "ffG43a1.itp"

[ moleculetype ]
; Name            nrexcl
PropPent          3

[ atoms ]
; nr type resnr residue atom cgnr  charge    mass  typeB chargeB  massB
  1    H    1     PROP    PH    1   0.398    1.008  CH3     0.0  15.035
  2   OA    1     PROP    PO    1  -0.548  15.9994  CH2     0.0  14.027
  3  CH2    1     PROP   PC1    1   0.150   14.027  CH2     0.0  14.027
  4  CH2    1     PROP   PC2    2   0.000   14.027
  5  CH3    1     PROP   PC3    2   0.000   15.035

[ bonds ]
;  ai    aj funct    par_A  par_B 
    1     2     2    gb_1   gb_26
    2     3     2    gb_17  gb_26
    3     4     2    gb_26  gb_26
    4     5     2    gb_26

[ pairs ]
;  ai    aj funct
    1     4     1
    2     5     1

[ angles ]
;  ai    aj    ak funct    par_A   par_B
    1     2     3     2    ga_11   ga_14
    2     3     4     2    ga_14   ga_14
    3     4     5     2    ga_14   ga_14

[ dihedrals ]
;  ai    aj    ak    al funct    par_A   par_B
    1     2     3     4     1    gd_12   gd_17
    2     3     4     5     1    gd_17   gd_17

[ system ]
; Name
Propanol to Pentane

[ molecules ]
; Compound        #mols
PropPent            200
\end{verbatim}}
Atoms that are not perturbed, {\tt PC2} and {\tt PC3}, do not need B parameter
specifications, the B parameters will be copied from the A parameters.
Bonded interactions between atoms that are not perturbed do not need B
parameter specifications, here this is the case for the last bond.
Topologies using the {\gromacs} force field need no bonded parameters at all,
since both the A and B parameters are determined by the atom types.
Non-bonded interactions involving one or two perturbed atoms use the 
free-energy perturbation functional forms.
Non-bonded interaction between two non-perturbed atoms use the normal
functional forms.
This means that when, for instance, only the charge of a particle is
perturbed, its Lennard-Jones interactions will also be affected when
lambda is not equal to zero or one.

Note that this topology uses the \gromosv{96} force field, in which the bonded
interactions are not determined by the atom types. The bonded interaction
strings are converted by the C-preprocessor. The force field parameter
files contain lines like:
{\small\begin{verbatim}
#define gb_26       0.1530  7.1500e+06

#define gd_17     0.000       5.86          3
\end{verbatim}}

\subsection{\swapindex{Constraint}{force}}
\label{subsec:constraintforce}
The constraint force between two atoms in one molecule can be calculated
with the free energy perturbation code by adding a constraint between the
two atoms, with a different length in the A and B topology. When the B length
is 1 nanometer longer than the A length and lambda is kept constant at zero,
the derivative of the Hamiltonian with respect to lambda is the constraint
force. For constraints between molecules the pull code can be used,
see \secref{pull}.
Below is an example for calculating the constraint force at 0.7 nanometer
between two methanes in water, by combining the two methanes into one molecule.
The added constraint is of function type 2, which means that it is not
used for generating exclusions (see~\ssecref{excl}).
{\small\begin{verbatim}
; Include forcefield parameters
#include "ffG43a1.itp"

[ moleculetype ]
; Name            nrexcl
Methanes               1

[ atoms ]
; nr   type   resnr  residu   atom    cgnr     charge    mass
   1    CH4     1     CH4      C1       1          0    16.043
   2    CH4     1     CH4      C2       2          0    16.043

[ constraints ]
;  ai    aj funct   length_A  length_B
    1     2     2        0.7       1.7

#include "spc.itp"

[ system ]
; Name
Methanes in Water

[ molecules ]
; Compound        #mols
Methanes              1
SOL                2002
\end{verbatim}}

\subsection{Coordinate file}
\label{subsec:grofile}
Files with the {\tt .gro} file extension contain a molecular structure in 
\gromos{87} format. A sample piece is included below:
{\small\begin{verbatim}
MD of 2 waters, reformat step, PA aug-91
    6
    1WATER  OW1    1   0.126   1.624   1.679  0.1227 -0.0580  0.0434
    1WATER  HW2    2   0.190   1.661   1.747  0.8085  0.3191 -0.7791
    1WATER  HW3    3   0.177   1.568   1.613 -0.9045 -2.6469  1.3180
    2WATER  OW1    4   1.275   0.053   0.622  0.2519  0.3140 -0.1734
    2WATER  HW2    5   1.337   0.002   0.680 -1.0641 -1.1349  0.0257
    2WATER  HW3    6   1.326   0.120   0.568  1.9427 -0.8216 -0.0244
   1.82060   1.82060   1.82060
\end{verbatim}}
This format is fixed, {\ie} all columns are in a fixed position. If you
want to read such a file in your own program without using the
{\gromacs} libraries you can use the following formats:

{\bf C-format:} \verb'"%5i%5s%5s%5i%8.3f%8.3f%8.3f%8.4f%8.4f%8.4f"'

Or to be more precise, with title etc., it looks like this:
\begin{verbatim}
  "%s\n", Title
  "%5d\n", natoms
  for (i=0; (i<natoms); i++) {
    "%5d%5s%5s%5d%8.3f%8.3f%8.3f%8.4f%8.4f%8.4f\n",
      residuenr,residuename,atomname,atomnr,x,y,z,vx,vy,vz
  }
  "%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f%10.5f\n",
    box[X][X],box[Y][Y],box[Z][Z],
    box[X][Y],box[X][Z],box[Y][X],box[Y][Z],box[Z][X],box[Z][Y]
\end{verbatim}

{\bf Fortran format:} \verb'(i5,2a5,i5,3f8.3,3f8.4)'

So {\tt confin.gro} is the {\gromacs} coordinate file and is almost
the same as the \gromosv{87} file (for {\gromos} users: when used with
ntx=7).  The only difference is the box for which {\gromacs} uses a
tensor, not a vector.
