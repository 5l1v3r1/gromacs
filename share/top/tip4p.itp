;
; Note the strange order of atoms to make it faster in gromacs.
;
[ moleculetype ]
; molname	nrexcl
SOL		2

[ atoms ]
; id	at type	res nr 	residu name	at name	cg nr	charge
#ifdef FF_OPLS
1	opls_115	1	SOL	MW1	1      -1.04
2	opls_114	1	SOL	HW2	1	0.52
3	opls_114	1	SOL	HW3	1	0.52
4	opls_113	1	SOL	OW4	1	0
#else
#ifdef _FF_GROMOS96
1	IW		1	SOL	MW1	1      -1.04 	0.0
2	H		1	SOL	HW2	1	0.52 	1.008	
3	H		1	SOL	HW3	1	0.52 	1.008
4	OWT4		1	SOL	OW4	1	0	15.9994
#else
1	IW		1	SOL	MW1	1      -1.04
2	HW		1	SOL	HW2	1	0.52
3	HW		1	SOL	HW3	1	0.52
4	OWT4		1	SOL	OW4	1	0
#endif
#endif

#ifdef FLEXIBLE
[ bonds ]
; i	j	funct	length	force.c.
4	2	1	0.09572	502416.0 0.09572	502416.0 
4	3	1	0.09572	502416.0 0.09572	502416.0 
	
[ angles ]
; i	j	k	funct	angle	force.c.
2	4	3	1	104.52	628.02	104.52	628.02	

#else
[ constraints ]
; i	funct	doh	dhh
4	2	1	0.09572
4	3	1	0.09572
3	2	1	0.15139

[ exclusions ]
1	2	3	4
2	1	3	4
3	1	2	4
4	1	2	3
#endif

; The position of the dummy is computed as follows:
;
;		O
;  	      
;	    	D
;	  
;	H		H
;
; const = distance (OD) / [ cos (angle(DOH)) 	* distance (OH) ]
;	  0.015 nm	/ [ cos (52.26 deg)	* 0.09572 nm	]

; Dummy pos x4 = x1 + a*(x2-x1) + b*(x3-x1)

[ dummies3 ]
; Dummy from			funct	a		b
1	4	2	3	1	0.128012065	0.128012065

