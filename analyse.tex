\chapter{Analysis.}
\label{ch:analysis}
In this chapter different ways of analysing your trajectory are described. 
The names of the corresponding analysis programs are given. 
Specific info on the in- and output of these programs can be found 
in the on-line manual or in Appendix~\ref{ch:online}. 
Often the output files are in {\tt xvgr}-format.

First in section~\ref{sec:groups} the group concept in analysis is explained. 
Then the different analysis tools are presented.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Groups in Analysis
%
\section{Groups in Analysis.}
\label{sec:groups}
\begin{verbatim}
make_ndx
mk_angndx
\end{verbatim}
In chapter~\ref{ch:algorithms} it was explained how {\em groups of atoms} can 
be used in the MD-program. 
In most analysis programs an index file is necessary too to select groups to
work on. Let's consider a simulation of a binary mixture of components A and
B. When we want to calculate the radial distribution function (rdf) 
$g_{AB}(r)$ of A with respect to B, we have to calculate
\beq
4\pi r^2 g_{AB}(r)	~=~	V~\sum_{i \in A}^{N_A} \sum_{j \in B}^{N_B} P(r)
\eeq
where $V$ is the volume and $P(r)$ is the probability to find a B atom
at a distance $r$ from an A atom.

By having the user define the {\em atom numbers} for groups A and B in
a simple file we can calculate this $g_{AB}$ in the most general way, without
having to make any assumptions in the rdf-program about the type of 
particles. 

Groups can therefore consist of a series of {\em atom numbers}, but in
some cases also of {\em molecule numbers}.  It is also possible to
specify a series of angles by {\em triples} of {\em atom numbers},
dihedrals by {\em quatriples} of {\em atom numbers} and bonds or
vectors (in a molecule) by {\em couples} of {\em atom numbers}. When
appropriate the type of index-file will be specified for the following
analysis programs.  To help creating such index-files ({\tt
index.ndx}), there are a couple of programs to generate them, using
either your input configuration or the topology.  To generate an
index-file consisting of a series of {\em atom numbers} (as in the
example of $g_{AB}$) use {\tt make\_ndx}. To generate an index-file
with angles or dihedrals, use {\tt mk\_angndx}. Of course you can also
make them by hand. The general format is presented here:
\begin{verbatim}
 3    24
group_1   3    0     1     2
group_2   6    3     4     5     6     7     8
group_3  15    9    10    11    12    13    14    15    16    17    
18    19    20    21    22    23
\end{verbatim}
On the first line the number of groups (3) and the total number of elements 
in the file (3+6+15=24) are given. Then all groups are given. 
(It is not necessary to write each group at {\em one} line. The routine that 
reads the index-file just skips line returns.) First the group-name is 
written, followed by the number of elements in that group and the atom or 
molecule numbers.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Looking at your trajectory
%
\section{Looking at your trajectory}
\label{sec:lookwhostalking}
\begin{verbatim}
ngmx
\end{verbatim}
%
\begin{figure}[hbtp]
\centerline{
{\psfig {figure=plots/ngmxdump.eps,width=8cm,angle=90}}}
\caption{A hard-copy of {\tt ngmx} showing a box of water.}
\label{fig:ngmxdump}
\end{figure}
%
Before analysing your trajectory it is often informative to look at your 
trajectory first. There is a special graphics program {\tt ngmx} to show your 
binary trajectory. Within the program you can also monitor energies, 
temperature etc. It is also possible to generate a hard-copy in Encapsulated 
Postscript format, see fig.~\ref{fig:ngmxdump}.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% General properties
%
\section{General properties}
\label{sec:genprop}
\begin{verbatim}
g_ener
g_pvd
g_com
\end{verbatim}
To analyse some or all {\em energies} in your simulation in time, use the 
program {\tt g\_ener}. You can choose interactively from a list a set 
of energies, like potential, kinetic or total energy. Individual 
contributions, like Lennard-Jones or dihedral energies, can be printed as well.

Other properties, such as {\em total pressure, pressure tensor, density, 
box-volume} and {\em box-sizes} can be monitored by the program {\tt g\_pvd}.  

The {\em centre-of-mass velocity}, defined as
\beq
{\bf v}_{com} = {1 \over M} \sum_{i=1}^N m_i {\bf v}_i
\eeq
with $M = \sum_{i=1}^N m_i$ the total mass of the system, can be monitored 
in time by the program {\tt g\_com}. It is however recommended to remove the 
centre-of-mass velecity every step (see chapter~\ref{ch:algorithms})!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Radial distribution functions 
%
\section{Radial distribution functions}
\label{sec:rdf}
\begin{verbatim}
g_rdf
\end{verbatim}
The {\em radial distribution function} (rdf) or pair correlation function 
$g_{AB}(r)$ between particles of type $A$ and $B$ is defined in the 
following way:
\bea
g_{AB}(r) &=& { < \rho_B(r)> \over <\rho_B>_{local}}\nonumber\\
&=& {1 \over <\rho_B>_{local} } {1 \over N_A} \sum_{i \in A}^{N_A} \sum_{j \in B}^{N_B} {\delta( r_{ij} - r ) \over 4 \pi r^2}
\eea
with $< \rho_B(r)>$ the particle density of type $B$ at a distance $r$ around 
particles $A$, and 
$<\rho_B>_{local}$ the particle density of type $B$ averaged over all 
spheres around particles $A$ with radius $r_{max}$ 
(see fig.~\ref{fig:rdfex}C). 
%
\begin{figure}[hbtp]
\centerline{
{\psfig {figure=plots/rdf.eps,width=7cm,angle=270}}}
\caption[Definition of slices in {\tt g\_rdf}.]{Definition of slices in {\tt g\_rdf}: A. $g_{AB}(r)$. B. $g_{AB}(r,\theta)$. The slices are coloured grey. C. Normalization $<\rho_B>_{local}$. D. Normalization $<\rho_B>_{local,\:\theta }$. Normalization volumes are coloured grey.}
\label{fig:rdfex}
\end{figure}
%
Usually the value of $r_{max}$ is half of the boxlength. 
The averaging is also performed in time. 
In practice the analysis program {\tt g\_rdf} divides 
the system into spherical slices (from $r$ to $r+dr$, 
see fig.~\ref{fig:rdfex}A) and makes a histogram in stead of the 
$\delta$-function. An example of the rdf of Oxygen-Oxygen 
in SPC-water~\cite{Berendsen81} is given in fig.~\ref{fig:rdf}.
%
\begin{figure}[bhtp]
\centerline{
{\psfig {figure=plots/rdfO_O.eps,width=7cm,angle=270}}}
\caption{$g_{OO}(r)$ for Oxygen-Oxygen of SPC-water.}
\label{fig:rdf}
\end{figure}
%

With {\tt g\_rdf} it is also possible to calculate an angle dependent rdf 
$g_{AB}(r,\theta)$, where the angle $\theta$ is defined with respect to a 
certain laboratory axis ${\bf e}$, see fig.~\ref{fig:rdfex}B.
\bea 
g_{AB}(r,\theta) &=& {1 \over <\rho_B>_{local,\:\theta }} {1 \over N_A} \sum_{i \in A}^{N_A} \sum_{j \in B}^{N_B} {\delta( r_{ij} - r ) \delta(\theta_{ij} -\theta) \over 2 \pi r^2 sin(\theta)}\\
cos(\theta_{ij}) &=& {{\bf r}_{ij} \cdot {\bf e} \over \|r_{ij}\| \;\| e\| }
\eea
This $g_{AB}(r,\theta)$ is useful for analysing anisotropic systems. 
Note that in this case the normalization $<\rho_B>_{local,\:\theta}$ is 
the average density in all angle slices from $\theta$ to $\theta + d\theta$ 
up to $r_{max}$, so angle dependent, see fig.~\ref{fig:rdfex}D.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Correlation functions 
%
\section{Correlation functions}
\label{sec:corr}
\begin{verbatim}
g_msd
g_velacc
g_dipoles
\end{verbatim}
With \gromacs~several correlation functions can be calculated. 

To determine the self diffusion coefficient $D_A$ of particles $A$ one
can use the Einstein relation~\cite{Allen87} \beq \lim_{t \rightarrow
\infty} <|{\bf r}_i(t) - {\bf r}_i(0)|^2>_{i \in A} ~=~ 6 D_A t \eeq
This {\em Mean Square Displacement} and $D_A$ is calculated by the
program {\tt g\_msd}. For molecules consisting of more than one atom,
${\bf r}_i$ is the centre of mass positions. In that case you should
use an index-file with molecule numbers! The program can also be used
for calculating diffusion in one or two dimensions. This is useful for
studying lateral diffusion on interfaces. 

An example of the self diffusion of SPC-water is given in
fig.~\ref{fig:msdwater}.
%
\begin{figure}[hbtp]
\centerline{
{\psfig {figure=plots/msdwater.eps,width=6.5cm,angle=270}}}
\caption{Mean Square Displacement of SPC-water.}
\label{fig:msdwater}
\end{figure}
%

The self diffusion coefficient can also be calculated using the Green-Kubo 
relation~\cite{Allen87}
\beq
D_A ~=~ {1\over 3} \int_0^{\infty} < {\bf v}_i(t) \cdot {\bf v}_i(0) >_{i \in A} \; dt
\eeq
The program {\tt g\_velacc} calculates this {\em Velocity AutoCorrelation 
Function}.

Another important quantity is the dipole correlation time. The {\em dipole 
correlation function} for particles $A$ is calculated as follows by {\tt g\_dipoles}:
\beq
C_{\mu} (\tau) ~=~ < {\bf \mu}_i(\tau) \cdot {\bf \mu}_i(0) >_{i \in A}
\eeq
with ${\bf \mu}_i = \sum_{j \in i} {\bf r}_j q_j$. The dipole correlation time is simply $\int_0^{\infty} C_{\mu} (\tau) \; d\tau$.
% 
%%%%%%%%%%%%%%%%%%%%% Bonds, angles and dihedral %%%%%%%%%%%%%%%%%%%
% 
\section{Bonds, angles and dihedrals}
\label{sec:bad}
\begin{verbatim}
g_bond
g_angle
g_sgangle
\end{verbatim}
To monitor specific {\em bonds} in your molecules during time, the program 
{\tt g\_bond} calculates the distribution of the bondlength in time. 
The index-file consists of pairs of atom numbers, for example
\begin{verbatim}
2   8
bonds_1    6    0     1
                2     3
                8     9
bonds_2    2   11    12
\end{verbatim}

The program {\tt g\_angle} calculates the distribution of {\em angles} and 
{\em dihedrals} in time. It also gives the average angle or dihedral. 
The index-file consists of triples or quatriples of atom numbers:
\begin{verbatim}
2   17
angles     9   0     1     2
               1     2     3
               2     3     4
dihedrals  8   0     1     2     3
               1     2     3     4
\end{verbatim}
For the dihedral angles you can use eighter the ``biochemical convention'' 
($\phi = 0 \equiv cis$) or ``polymer convention'' ($\phi = 0 \equiv trans$), 
see fig~\ref{fig:dih_def}.
%
\begin{figure}[hbtp]
\centerline{
{\psfig {figure=plots/dih_def.eps,width=3.5cm,angle=270}}}
\caption{Dihedral conventions: A. ``Biochemical convention''. B. ``Polymer convention''.}
\label{fig:dih_def}
\end{figure}
%

To follow specific {\em angles} in time between two vectors, a vector and 
a plane or 
two planes (defined by 2, resp. 3 atoms inside your molecule, see 
fig.~\ref{fig:sgangle}A, B, C), use the program {\tt g\_sgangle}. 
%
\begin{figure}[hbtp]
\centerline{
{\psfig {figure=plots/sgangle.eps,width=6.5cm,angle=270}}}
\caption[Options of {\tt g\_sgangle}.]{Options of {\tt g\_sgangle}: A. Angle between 2 vectors. B. Angle between a vector and the normal of a plane. C. Angle between two planes. D. Distance between the geometrical centres of 2 planes. E. Distances between a vector and the centre of a plane.}
\label{fig:sgangle}
\end{figure}
%
For planes it uses the normal vector perpendicular to the plane. 
It can also calculate the {\em distance} $d$ between the geometrical centre 
of two planes (see fig.~\ref{fig:sgangle}D), and the distances 
$d_1$ and $d_2$ between 2 atoms (of a vector) and the centre of a plane 
defined by 3 atoms (see fig.~\ref{fig:sgangle}D). It further calculates the 
distance $d$ between the centre of the plane and the middle of this vector. 
Depending on the input groups (i.e. groups of 2 or 3 atom numbers), the 
program decides what angles and distances to calculate. For example, the index-file could look like this:
\begin{verbatim}
2   5
a_plane   3     0     1     2
a_vector  2     3     4
\end{verbatim}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Radius of gyration and distances
%
\section{Radius of gyration and distances}
\label{sec:rg}
\begin{verbatim}
g_gyrate
g_sgangle
g_mindist
g_mdmat
mat2ps
\end{verbatim}
To have a rough measure for the compactness of a structure, you can calculate 
the {\em radius of gyration} with the program {\tt g\_gyrate} as follows:
\beq
R_g ~=~ \left({\frac{\sum_i {\bf r}_i^2 m_i}{\sum_i m_i}}\right)^{\half}
\label{eq:rg}
\eeq
where $m_i$ is the mass of atom $i$ and ${\bf r}_i$ the position of 
atom $i$ with respect to the center of mass of the molecule. It is especially 
useful to characterize polymer solutions and proteins.

Sometimes it is interesting to plot the {\em distance} between two atoms,
or the {\em minimum} distance between two groups of atoms
(eg.: protein sidechains in a salt bridge). 
To calculate these distances between certain groups there are several 
possibilities:
\begin{description}
\item[$\bullet$] 
The {\em distance between the geometrical centres} of two groups can be 
calculated with {\tt g\_sgangle}, as explained in section~\ref{sec:bad}. 
\item[$\bullet$] 
The {\em minumum distance} between two groups of atoms during time 
can be calculated with the program {\tt g\_mindist}. It also calculates the 
{\em number of contacts} between these groups 
within a certain radius $r_{max}$.
\item[$\bullet$] 
To monitor the {\em minimum distances between residues} 
(see chapter~\ref{ch:top}) within a (protein) molecule, you can use 
the program {\tt g\_mdmat}. This minimum distance between two residues
A$_i$ and A$_j$ is defined as the smallest distance between any pair of 
atoms (i $\in$ A$_i$, j $\in$ A$_j$).
The output is a symmetrical matrix of smallest distances 
between all residues. To visualize this matrix, you can convert it with 
{\tt mat2ps} into a Postscript picture, see fig.~\ref{fig:mdmat}.
%
\begin{figure}[hbtp]
\centerline{
\psfig {figure=plots/distm.eps,width=6.5cm}}
\caption{A minimum distance matrix for a protein at time $t=0$.}
\label{fig:mdmat}
\end{figure}
%
Plotting these matrices for different timeframes, one can analyse changes 
in the structure, and e.g. forming of salt bridges.
\end{description}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Root mean square deviations 
%
\section{Root mean square deviations in structure}
\label{sec:rmsd}
\begin{verbatim}
g_rms
g_rms_mat
g_run_rms
\end{verbatim}
The {\em root mean square deviation} (RMSD) of certain atoms in a molecule
with respect to a reference structure can be calculated with the program 
{\tt g\_rms} by least-square fitting the structure to the reference structure
and subsequently calculating the RMSD (eq.~\ref{eq:rmsd}).
\beq
RMSD(t)	~=~ \left[\frac{1}{N} \sum_{i=1}^N ({\bf r}_i(t)-{\bf r}_i(0))^2 \right]^{\frac{1}{2}}
\label{eq:rmsd}
\eeq
where ${\bf r}_i(t)$ is the position of atom $i$ at time $t$.
{\bf NOTE} that fitting does not have to use the same atoms as the calculation
of the $RMSD$; eg.: a protein is usually fitted on the backbone atoms
(N,C$_{\alpha}$,C), but the $RMSD$ can be computed of the backbone
or of the whole protein.

Alternatively the $RMSD$ can be computed using a fit-free method with the 
program {\tt g\_rms\_mat}:
\beq
RMSD(t)	~=~	\left[\frac{1}{N^2}\sum_{i=1}^N	\sum_{j=1}^N	({\bf r}_{ij}(t)-{\bf r}_{ij}(0))^2\right]^{\frac{1}{2}}
\label{eq:rmsdff}
\eeq
where the {\em distance} {\bf r}$_{ij}$ between atoms at time $t$ 
is compared with the distance between the same atoms at time $0$.

In stead of comparing the structures to the initial structure at time $t=0$ 
(so for example a cristal structure), one can also calculate eq.~\ref{eq:rmsd} 
using a timeshift $\tau$:
\beq
RMSD(t;\tau) ~=~ \left[\frac{1}{N} \sum_{i=1}^N ({\bf r}_i(t)-{\bf r}_i(t-\tau))^2 \right]^{\frac{1}{2}}
\label{eq:rmdstau}
\eeq
so comparing to a least-square structure at $t-\tau$. This gives some insight 
in the mobility as a function of $\tau$. Use the program {\tt g\_run\_rms}.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Hydrogen bonds
%
\section{Hydrogen bonds}
\begin{verbatim}
g_hbond
g_lifetime
\end{verbatim}
The program {\tt g\_hbond} analyses the {\em hydrogen bonds} (H-bonds) 
between all possible donors D and acceptors A. 
To determine if a H-bond is formed, a 
geometrical criterion is used, see fig.~\ref{fig:hbond}. A H-bond is said to 
exist if the distance between donor and acceptor $r$ is smaller then a certain 
maximum value $r_{HB}$. Further the angle $\alpha$ must be smaller then a 
certain maximum angle $\alpha_{HB}$. Default values of $r_{HB}$ and 
$\alpha_{HB}$ are
\bea
r &\leq& 3.5 \AA \nonumber\\
\alpha &\leq& 60^o \nonumber
\eea
%
\begin{figure}[hbtp]
\centerline{\psfig{figure=plots/hbond.eps,width=2.5cm,angle=270}}
\caption{Geometrical Hydrogen bond criterion.}
\label{fig:hbond}
\end{figure}
%
The value of $r_{HB} = 3.5 \AA$ corresponds to the first minimum of the rdf of 
SPC-water (see also fig.~\ref{fig:rdf}).

The program {\tt g\_hbond} analyses for one or more selected groups of atoms 
the following things:
\begin{description}
\item[$\bullet$]
The existence of H-bonds fulfilling the geometrical criterion. The program 
prints a file containing all H-bonds which occurred during the simulation. 
\item[$\bullet$]
The distribution of the distances $r$ between Donor and Acceptor of the 
H-bonds found during the whole simulation.
\item[$\bullet$]
The distribution of the angles $\alpha$ (H-D-A) of the 
H-bonds found during the whole simulation.
\item[$\bullet$]
The number of H-bonds in time. This is divided into 
{\em intra molecular}, {\em inter molecular} and {\em all} H-bonds. 
\item[$\bullet$]
The number of H-bonds in time between (protein) backbone residues. 
For residue number $n$ this is divided into interactions with 
residues $n+3$, $n+4$ and $n+5$. This provides a measure of forming of 
$\alpha$-helices or $\beta$-turns or strands.
\item[$\bullet$]
The lifetime of the H-bonds can be calculated as follows. The program writes 
a matrix containing either ``1'' or ``0'', meaning that in that timeframe a 
specific H-bond is or is not present. Now you can calculate the following 
correlation function with {\tt g\_lifetime}, using this matrix
\beq
C(\tau) ~=~ < s_i(t)\; s_i(t\:+\:\tau) >
\label{eq:hbcorr}
\eeq
with $s_i(t) = \{0,1\}$ for H-bond $i$ at time $t$. The integral of $C(\tau)$ 
gives the estimated lifetime $\tau_{HB}$ of the H-bonds
\beq
\tau_{HB} ~=~ \int_{0}^{\infty} C(\tau) d\tau
\label{eq:hblife}
\eeq
\end{description}

For the analysis you can specify {\em one} group of atoms. Then only the 
H-bonds {\em inside} this group are monitored. You can also specify {\em two} 
or {\em more} groups. In that case the program only analyses the H-bonds 
{\em between} those groups. 

It is also possible to analyse specific H-bonds. To do so, your index-file has 
to contain a {\em group of H-bonds}, in the following way:
\begin{verbatim}
    3     24
internal     12 
    20    21    24
    25    26    29
     0     3     6
    47    48    52
intermolecular      0 
all_bonds     12 
    20    21    24
    25    26    29
     0     3     6
    47    48    52
\end{verbatim}
So after the usual definitions of the groups each group consists of 
{\em triples} of atom numbers, i.e. Donor, Hydrogen and Acceptor. 
You can for example use the index-file which is generated by the program when 
analysing one or more groups. The output, besides the normal output, is a 
``matrix'' in time. For every specified H-bond is indicated whether or not 
this H-bond is formed at that timeframe. An existing H-bond is indicated by 
a ``|''. A typical example is given here for an $\alpha$-helix with 15 
possible H-bonds:
{\small 
\begin{verbatim} 
 0.00  (|||||          )
 0.50  (||||||         )
 1.00  (||||||         )
 1.50  (| || |         )
 2.00  (|||| ||        )
 2.50  (||||||         )
 3.00  ( |||||         )
 3.50  ( ||| ||        )
 4.00  ( |||||         )
 4.50  ( ||            )
 5.00  ( ||  | |       )
 5.50  ( ||  ||        )
 6.00  ( |||  |        )
 6.50  ( ||| || |      )
 7.00  ( ||| ||        )
 7.50  ( ||| |         )
 8.00  (  || ||        )
 8.50  ( |||||         )
 9.00  ( ||| ||        )
 9.50  ( | |  | ||     )
10.00  ( |||||         )
\end{verbatim} }

It is also possible to analyse the insertion of solvent molecules (eg. water) 
in specific hydrogen bonds (eg. $\alpha$-helices), see fig.~\ref{fig:insert}
 %
\begin{figure}[hbtp]
\centerline{
{\psfig {figure=plots/hbond_insert.eps,width=5cm,angle=270}}}
\caption[Insertion of water in $\alpha$-helix.]{Insertion of water in $\alpha$-helix. (1) Normal H-bond between two residues. (2) H-bonding bridge via a water molecule.}
\label{fig:insert}
\end{figure}
The program analyses the forming of H-bond bridges between two helix residues 
via any solvent molecule (water) of a specified group of solvent molecules. 
Besides the normal output (angle and distance distributions etc.) the program 
will produce also a matrix, now ``|'' means the existance of a usual H-bond 
between D and A of the helix (fig.~\ref{fig:insert},(1)), ``-'' means that a bridging H-bond as 
in fig.~\ref{fig:insert},(2) is formed, and ``+'' means that both exist.
{\small 
\begin{verbatim}
 0.00  (|||||   --     )
 0.50  (||||+|- --     )
 1.00  (||||||  -      )
 1.50  (| || +- - -    )
 2.00  (||||-|+ --     )
 2.50  (|||+||-        )
 3.00  ( +||++    --  -)
 3.50  ( ||+-|+ --  -  )
 4.00  ( |||||- --     )
 4.50  ( || ---   -    )
 5.00  ( || -|-|-      )
 5.50  ( ||--|+ --  -  )
 6.00  ( ||| -+ - -    )
 6.50  ( ||+-+| | - -  )
 7.00  ( |||-+|   -    )
 7.50  (-||+ + -- - -  )
 8.00  (  ||-||        )
 8.50  ( |||++ -  -    )
 9.00  ( ||+-++   - -  )
 9.50  ( | |--+ +|-    )
10.00  ( |||++- ---    )
\end{verbatim} } 
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Protein related items 
%
\section{Protein related items}
\begin{verbatim}
do_dssp
g_rama
xrama
wheel
\end{verbatim}
To analyse structural changes of a protein, you can calculate the radius of 
gyration or the minimum residue distances during time 
(see section~\ref{sec:rg}), or calculate the RMSD (section~\ref{sec:rmsd}).

You can also look at the changing of {\em secondary structure elements} 
during your run. For this you can use the program {\tt do\_dssp}, which is 
an interface for the commercial program {\tt dssp}~\cite{Kabsch83}. For 
further information, see the {\tt dssp}-manual. A tyical output plot of 
{\tt do\_dssp} is given in fig.~\ref{fig:dssp}.
%
\begin{figure}[hbtp]
\centerline{
\psfig {figure=plots/dssp.eps,width=12cm}}
\caption{Analysis of the secondary structure elements of a small protein in time.}
\label{fig:dssp}
\end{figure}
%

One other important analysis of proteins is the so called 
{\em Ramachandran plot}. 
This is the projection of the structure on the two dihedral angles $\phi$ and 
$\psi$ of the protein backbone, see fig.~\ref{fig:phipsi}.
%
\begin{figure}[hbtp]
\centerline{
\psfig {figure=plots/phipsi.eps,width=5cm}}
\caption{Definition of the dihedral angles $\phi$ and $\psi$ of the protein backbone.}
\label{fig:phipsi}
\end{figure}
%
To evaluate this Ramachandran plot you can use the program {\tt g\_rama}. 
A typical output is given in fig.~\ref{fig:rama}.
%
\begin{figure}[hbtp]
\centerline{
{\psfig {figure=plots/rama.eps,width=9cm,angle=270}}}
\caption{Ramachandran plot of a small protein.}
\label{fig:rama}
\end{figure}
%

It is also possible to generate an {\em animation of the Ramachandran plot} 
in time. This can be of help for analysing certain dihedral transitions 
in your protein. You can use the program {\tt xrama} for this.

%
When studying $\alpha$-helices 
it is useful to have a {\em helical wheel} projection
of your peptide, to see whether a peptide is amphipatic. This can be done
using the {\tt wheel} program. Two examples are 
plotted in fig.~\ref{fig:wheel}.
%
\begin{figure}[hbtp]
\centerline{\psfig{figure=plots/hpr-wheel.eps,width=\htw}}
\caption{Helical wheel projection of the N-terminal helix of HPr.}
\label{fig:wheel}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Membrane Related Items
%
\section{Interface related items}
\begin{verbatim}
g_order
g_density
g_potential
g_coord
\end{verbatim}

When simulating molecules with long carbon tails, it can be
interesting to calculate their average orientation. There are several
flavours of order parameters, most of which are related. The program
{\tt g\_order} can calculate orderparameters using the equation

\begin{equation}
S_{z} = \frac{3}{2}\langle {\cos^2{\theta_z}} \rangle - \frac{1}{2}
\label{eq:Sgr}
\end{equation}
where $\theta_z$ is the angle between the $z$-axis of the simulation
box and the molecular axis under consideration. The latter is defined as the
vector from C$_{n-1}$ to C$_{n+1}$. The parameters $S_x$
and $S_y$ are defined in the same way. The brackets imply averaging over time
and molecules. Order parameters can vary between 1 (full order along
the interface normal) and $-1/2$ (full order perpendicular to the
normal), with a value of zero in the case of isotropic orientation.

The program can do two things for you. It can calculate the order
parameter for each CH$_2$ segment seperately, for any of three axes,
or it can divide the box in slices and calculate the average value of
the order parameter per segment in one slice. The first method gives
an idea of the ordering of a molecule from head to tail, the second
method gives an idea of the ordering as function of the boxlength.

The electrostatic potential ($\psi$) across the interface can be
computed from a trajectory by evaluating the double integral of the
charge density ($\rho(z)$):
\beq
\psi(z) - \psi(-\infty) = - \int_{-\infty}^z dz' \int_{-\infty}^{z'} \rho(z'')dz''/ \epsilon_0 
\label{eq:elpotgr}
\eeq
where the position $z=-\infty$ is far enough in the bulk phase that
the field is zero.  With this method, it is possible to ``split'' the
total potential into separate contributions from lipid and water
molecules. The program {\tt g\_potential} divides the box in slices and
sums all charges of the atoms in each slice. It then integrates this
charge density, giving the electric field, and the electric field,
giving the potential. Charge density, field and potential are written
to {\tt xvgr-}input files.

The program {\tt g\_coord} is a very simple analysis program. All it
does is print the coordinates of selected atoms to three files,
containing respectively the {\em x-, y-} and {\em z-}coordinates of
those atoms. It can also calculate the center of mass of one or more
molecules and print the coordinates of the center of mass to three
files. By itself, this is probably not a very useful analysis, but
having the coordinates of selected molecules or atoms can be very
handy for further analysis, not only in interface systems.

The program {\tt g\_pvd} calculates a lot of properties, among which
the density of a group in particles per unit of volume, but not a
density that takes the mass of the atoms into account. The program
{\tt g\_density} also calculates the density of a group, but takes the
masses into account and gives a plot of the density (in g/cm$^3$)
against a box axis. This is useful for looking at the distribution of
groups or atoms across the interface. 

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Chemical shifts
%
\section{Chemical shifts}
\begin{verbatim}
total
\end{verbatim}
You can compute the NMR chemical shifts of protons with the program 
{\tt do\_shift}. This is just an \gromacs~interface to the public domain 
program 
{\tt total}~\cite{Williamson93a}. For further information, read the article.

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%


